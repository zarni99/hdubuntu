{
  "timezone": "UTC",
  "enable_ntp": true,
  "enable_unattended_upgrades": true,
  "backup_configs": true,
  "dry_run": false,
  "step1": {
    "update_system": true,
    "setup_unattended_upgrades": true,
    "configure_timezone_ntp": true
  },
  "step2": {
    "create_users": true,
    "configure_ssh": true
  },
  "step3": {
    "configure_firewall": true,
    "disable_unused_services": true
  },
  "step4": {
    "configure_sysctl": true,
    "apply_sysctl": true,
    "verify_sysctl": true
  },
  "step5": {
    "install_auditd": true,
    "configure_auditd": true,
    "configure_rsyslog": true,
    "enable_services": true
  },
  "users": [
    {
      "username": "outsight",
      "groups": ["sudo"],
      "description": "Install and configure software stack, Level 3 troubleshooting"
    },
    {
      "username": "cableman",
      "groups": ["sudo"],
      "description": "Server installation & administration, security update, audit, Level 1&2 troubleshooting"
    },
    {
      "username": "cag",
      "groups": [],
      "description": "Audit user"
    }
  ],
  "ssh_allowed_users": ["outsight", "cableman", "cag"],
  "firewall": {
    "default_incoming": "deny",
    "default_outgoing": "allow",
    "essential_ports": [
      {
        "port": "ssh",
        "protocol": "tcp",
        "description": "SSH remote access"
      },
      {
        "port": "ntp",
        "protocol": "udp",
        "description": "NTP time synchronization"
      }
    ],
    "k3s_ports": [
      {
        "port": "6443",
        "protocol": "tcp",
        "description": "K3s API server"
      },
      {
        "port": "8472",
        "protocol": "udp",
        "description": "Flannel VXLAN"
      },
      {
        "port": "10250",
        "protocol": "tcp",
        "description": "Kubelet metrics"
      }
    ],
    "outsight_ports": [
      {
        "port": "80",
        "protocol": "tcp",
        "description": "Outsight Shift HTTP"
      },
      {
        "port": "443",
        "protocol": "tcp",
        "description": "Outsight Shift HTTPS"
      },
      {
        "port": "2379:2380",
        "protocol": "tcp",
        "description": "HA configuration database"
      },
      {
        "port": "5001",
        "protocol": "tcp",
        "description": "Embedded distributed registry"
      },
      {
        "port": "5000",
        "protocol": "tcp",
        "description": "Software monitoring"
      },
      {
        "port": "53",
        "protocol": "udp",
        "description": "Core DNS"
      },
      {
        "port": "11100:11130",
        "protocol": "tcp",
        "description": "Tracking data stream"
      },
      {
        "port": "9090",
        "protocol": "tcp",
        "description": "Software monitoring"
      },
      {
        "port": "9091",
        "protocol": "tcp",
        "description": "Software monitoring"
      },
      {
        "port": "9273",
        "protocol": "tcp",
        "description": "Software monitoring"
      },
      {
        "port": "10050",
        "protocol": "tcp",
        "description": "Hardware monitoring"
      },
      {
        "port": "10051",
        "protocol": "tcp",
        "description": "Hardware monitoring"
      },
      {
        "port": "5672",
        "protocol": "tcp",
        "description": "Internal message queues"
      },
      {
        "port": "15672",
        "protocol": "tcp",
        "description": "Internal message queues"
      }
    ]
  },
  "disable_services": [
    "avahi-daemon",
    "cups",
    "bluetooth"
  ],
  "sysctl": {
    "parameters": {
      "net.ipv4.ip_forward": "1",
      "net.ipv4.conf.all.rp_filter": "1",
      "net.ipv4.conf.default.rp_filter": "1",
      "net.ipv4.conf.all.accept_source_route": "0",
      "net.ipv6.conf.all.disable_ipv6": "1",
      "net.ipv6.conf.default.disable_ipv6": "1",
      "kernel.kptr_restrict": "1",
      "kernel.dmesg_restrict": "1",
      "fs.protected_hardlinks": "1",
      "fs.protected_symlinks": "1"
    }
  },
  "auditd": {
    "max_log_file": "100",
    "num_logs": "5",
    "space_left_action": "email",
    "action_mail_acct": "root",
    "admin_space_left_action": "halt",
    "max_log_file_action": "rotate",
    "disk_full_action": "halt",
    "disk_error_action": "halt"
  },
  "cis_profile": "Level 1 - Server",
  "organization": "CAG/Changi Airport Group",
  "compliance_requirements": [
    "CIS Ubuntu 22.04 LTS Benchmark",
    "CAG On-premise Server Requirements"
  ]
}